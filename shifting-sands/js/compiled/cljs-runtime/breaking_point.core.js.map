{"version":3,"sources":["breaking_point/core.cljs"],"mappings":";AAWA,AAAA,AAACA,AAEA,AAAAC,AAAKQ;AAAL,AAAA,AAAAP,AAAAD;AAAA,AAAAE,AAAAD,AAAA,AAAA,AAAQO;AAARL,AAAA,AAAAD,AAAAD,AAAA,AAAA;AAAAE,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAE,AAAAC,AAAAH,AAAAA;AAAAA,AAGiBQ;AAHjB,AAAAJ,AAAAJ,AAAA,AAAkBM;AAAlB,AAAAF,AAAAJ,AAAA,AACkBO;AADlB,AAAA,AAAA,AAIqBC;;AAWtB,AAAAC,AAAA;AAAAC,AAEC,AAAKE;AAAL,AACE,AAAMC,AAAc,AAAAC,AAAI,AAAAC,AAAQC;AAAR,AAAA,AAAA,AAAAD,AAAA;AAAA;;AAAA,AAAAA;;;AAAJ,AAAA,AAAAD;AAAAA;;AAAA,AAAAA,AAEI,AAAAG,AAAQC;AAARD,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAAA;AAAA,AAAA,AAAA,AAAAA,AAAA;AAAA;;AAAA,AAAAA;;;AAFJ,AAAA,AAAAH;AAAAA;;AAKI,AAAAK,AAAQD;AAARC,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAAA;AAAA,AAAA,AAAA,AAAAA,AAAA;AAAA;;AAAA,AAAAA;;;;;AAGlBC,AAAc,AAAAN,AAAI,AAAAO,AAAQL;AAAR,AAAA,AAAA,AAAAK,AAAA;AAAA;;AAAA,AAAAA;;;AAAJ,AAAA,AAAAP;AAAAA;;AAAA,AAAAA,AAEI,AAAAQ,AAAQJ;AAARI,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAAA;AAAA,AAAA,AAAA,AAAAA,AAAA;AAAA;;AAAA,AAAAA;;;AAFJ,AAAA,AAAAR;AAAAA;;AAKI,AAAAS,AAAQL;AAARK,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAAA;AAAA,AAAA,AAAA,AAAAA,AAAA;AAAA;;AAAA,AAAAA;;;;;AAbxB,AAgBE,AAAA,AAAA,AAACC,AAAMZ,AACcC,AACCO;;AArB3B,AAAA,AAAAX,AAAAC,AAAAD,AAAAC,AAACC,AAAAA,AAAAA;AA0BD,AAAA,AAAAc,AAAME,AAGqBtB;AAH3B,AAAA,AAAAqB,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAzB,AAAA,AAAAyB,AAAA,AAAA,AAAA,AAAA,AAAAxB,AAAAC,AAAAuB,AAAAA;AAAA,AAAAtB,AAAAsB,AAAA,AACWE;AADX,AAAAxB,AAAAsB,AAAA,AAEWb;AAFX,AAAAT,AAAAsB,AAAA,AAGWN;AAHX,AAAA,AAAA,AAIWQ,AACA,AAAA,AAAA,AAAA,AAACC,AAAuChB,AACxC,AAAA,AAAA,AAAA,AAACgB,AAAwCT;;AAEpD,AAAA,AAAA,AAACxB,AACiB,AAAA,AAAA,AAACkC,AAAAA,AAAAA,AACFH;AAEjB,AAAA,AAAC/B,AACgB,AAAAmC,AAAK1B;AAAL,AAAA,AAAA2B,AAAAD;AAAA,AAAAhC,AAAAiC,AAAA,AAAA,AAAQ3B;AAAR,AAAAN,AAAAiC,AAAA,AAAA,AAAUzB;AAAV,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAEiCA;;AAOlD,AAAA,AAAM0B,AAAkBL,AAAGvB;AAA3B,AACE,AAAA,AAAA,AAAA,AAAC6B,AAAON;;AAEV,AAAA,AAAMO,AAAmBP,AAAGvB;AAA5B,AACE,AAAA,AAAA,AAAA,AAAC6B,AAAON;;AAGV,AAAA,AAAMQ,AAAc9B;AAApB,AACE,AACGO,AAAaR;AADhB,AAEE,AAAMQ;AAAN,AACE,AAACwB,AACA,AAAAC,AAAKE;AAAL,AAAA,AAAAD,AAAAD;AAAA,AAAAvC,AAAAwC,AAAA,AAAA,AAAsBE;AAAtB,AAAA1C,AAAAwC,AAAA,AAAA,AAAiCG;AAAjC,AACE,AAAI,AAAI,AAAA,AAAMA,AACN,AAAK,AAAG7B,AAAa6B,AAChB,AAAI7B,AAAa2B;AAC5B,AAACG,AAAQF;;AACTC;;AANL,AAQC,AAAA,AAACE,AAAgBtC;;AATpB;;;;AAYJ,AAAA,AAAAuC,AAAME,AAEa1C;AAFnB,AAAA,AAAAyC,AAAAD;AAAA,AAAA9C,AAAA+C,AAAA,AAAA,AACIjC;AADJ,AAAAd,AAAA+C,AAAA,AAAA,AAEI1B;AAFJ,AAGE,AAAI,AAAGA,AACAP;AADP;;AAAA;;;AAMF,AAAA,AAAMmC,AAAe1C;AAArB,AACE,AAAA,AAAA,AAAC2C,AAAAA,AAAAA,AAA0BhB,AAAAA;;AAC3B,AAAA,AAAA,AAACgB,AAAAA,AAAAA,AAA2Bd,AAAAA;;AAE5B,AAAAe,AAAA;AAAAC,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAEY,AAACjB,AAAa9B;AAF1B,AAAA,AAAA4C,AAAAC,AAAAC,AAAAC,AAAAH,AAAAC,AAAAC,AAAAC,AAACJ,AAAAA,AAAAA;;AAID,AAAAK,AAAA;AAAAC,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAGYZ;AAHZ,AAAA,AAAAO,AAAAC,AAAAC,AAAAC,AAAAC,AAAAC,AAAAL,AAAAC,AAAAC,AAAAC,AAAAC,AAAAC,AAACV,AAAAA,AAAAA;;AAKD,AAAAW,AAAA;AAAAC,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAEY,AAAKC,AAAY3D;AAAjB,AACE,AAAA,AAAC4D,AAAED;;AAHjB,AAAA,AAAAJ,AAAAC,AAAAC,AAAAC,AAAAH,AAAAC,AAAAC,AAAAC,AAACd,AAAAA,AAAAA;;AAKD,AAAAiB,AAAA;AAAAC,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAEY,AAAKL,AAAY3D;AAAjB,AACE,AAAA,AAAC4D,AAAED;;AAHjB,AAAA,AAAAE,AAAAC,AAAAC,AAAAC,AAAAH,AAAAC,AAAAC,AAAAC,AAACpB,AAAAA,AAAAA;;AAKD,AAAMqB,AAAY,AAAAC,AAASjE;AAATiE,AAAA,AAAA,AAAAA,AAAA,AAAA,AACS,AAAAA,AAACC,AAAYC;AADtBF,AAAA,AAAA,AAAAA,AAAA,AAAA,AAES,AAACG,AAAO,AAAAC;AAAA,AAAA,AAAAC,AAAAD;AAAA,AAAA5E,AAAA6E,AAAA,AAAA,AAAMC;AAAN,AAAA9E,AAAA6E,AAAA,AAAA,AAAQE;AAAR,AACE,AAACC,AAAMF;AADjBN;AAFT,AAAA,AAAA,AAAAA,AAAA;AAAA;;AAIS,AAAAA,AAACS,AAAKC;;;AAJjC,AAKE,AAAAC,AAAA,AAAAC,AAAmBb;AAAnBc,AAAA;AAAAC,AAAA;AAAAC,AAAA;;AAAA,AAAA,AAAA,AAAA,AAAAA,AAAAD;AAAA,AAAA,AAAAD,AAAAE,AAAQ7C;AAAR,AAAA,AACE,AAAAsD,AAAY,AAAA,AAACQ,AACQ,AAAA,AAAK,AAACC,AAAK/D;AADhCuD,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAGY;AAAKO,AAAOpG;AAAZ,AACE,AAAC4D,AAAEwC,AACAhE;;;AALjB,AAAA,AAAAsD,AAAAC,AAAAC,AAAAC,AAAAH,AAAAC,AAAAC,AAAAC,AAACjD,AAAAA,AAAAA;;AADH;AAAA,AAAAiC;AAAAE;AAAAC;AAAA,AAAAC,AAAA;;;;;;;AAAA,AAAAC,AAAA,AAAAJ,AAAAD;AAAA,AAAA,AAAAK;AAAA,AAAA,AAAAL,AAAAK;AAAA,AAAA,AAAA,AAAAC,AAAAN;AAAA,AAAAO,AAAA,AAAAC,AAAAR;AAAA,AAAA,AAAA,AAAAS,AAAAT;AAAAO;AAAA,AAAAG,AAAAH;AAAA;;;;;;;AAAA,AAAA,AAAAI,AAAAX,AAAQzC;AAAR,AAAA,AACE,AAAA0D,AAAY,AAAA,AAACI,AACQ,AAAA,AAAK,AAACC,AAAK/D;AADhC2D,AAAA;AAAAC,AAAA,AAAA;AAAAC,AAGY;AAAKG,AAAOpG;AAAZ,AACE,AAAC4D,AAAEwC,AACAhE;;;AALjB,AAAA,AAAA0D,AAAAC,AAAAC,AAAAC,AAAAH,AAAAC,AAAAC,AAAAC,AAACrD,AAAAA,AAAAA;;AADH;AAAA,AAAA,AAAA6C,AAAAZ;AAAA;AAAA;AAAA;;;;;;;;AAAA;;;;;;AAWJ,AAAA,AAAAwB,AAAME;AAAN,AAAA,AAAAD,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA1G,AAAA,AAAA0G,AAAA,AAAA,AAAA,AAAA,AAAAzG,AAAAC,AAAAwG,AAAAA;AAAAA,AAE8BnG;AAF9B,AAAAJ,AAAAuG,AAAA,AAA+BrG;AAA/B,AAAAF,AAAAuG,AAAA,AAC+BpG;AAD/B,AAGE,AAACyC,AAAc1C;;AACf,AAAAuG,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACC,AAAAA,AAAAA;;AACD,AAAA,AAAA,AAAmB9F;AAAnB,AACoB,AAAIT;AACF,AAAAwG,AAAA,AAAA,AAAgDxG;AAAhD,AAAA,AAAAwG,AAAAA,AAACD,AAAAA,AAAAA;;AACD,AAAAE,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACF,AAAAA,AAAAA;;AAHvB;;AAMF,AAAA,AAAA,AAACG,AAAAA,AAAAA,AAEAL,AAAAA","names":["re_frame.core.reg_event_fx","p__48563","vec__48564","cljs.core.nth","map__48567","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.get","_","breakpoints","debounce-ms","opts","G__48574","G__48575","re-frame.core/reg-cofx","coeffect","screen-width","or__4126__auto__","G__48577","js/window","G__48589","js/document","G__48590","screen-height","G__48592","G__48594","G__48595","cljs.core.assoc","p__48603","map__48604","breaking-point.core/set-screen-dimensions","db","cljs.core/assoc-in","re-frame.core/inject-cofx","p__48610","vec__48611","breaking-point.core/get-screen-width","cljs.core.get_in","breaking-point.core/get-screen-height","breaking-point.core/->get-screen","cljs.core.reduce","p__48617","vec__48618","prev-breakpoint","screen-key","breakpoint","cljs.core/reduced","cljs.core.partition_all","p__48624","vec__48625","breaking-point.core/get-orientation","breaking-point.core/register-subs","re-frame.core/reg-sub","G__48635","G__48636","G__48637","G__48638","G__48641","G__48642","G__48643","G__48644","G__48645","G__48646","G__48655","G__48656","G__48657","G__48658","orientation","cljs.core._EQ_","G__48662","G__48663","G__48664","G__48665","screen-keys","G__48666","cljs.core.map_indexed","cljs.core/vector","cljs.core.filter","p__48669","vec__48670","i","k","cljs.core/even?","cljs.core.mapv","cljs.core/second","seq__48675","cljs.core/seq","chunk__48677","count__48678","i__48679","temp__5735__auto__","cljs.core/chunked-seq?","c__4556__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","G__48703","G__48704","G__48705","G__48706","G__48711","G__48712","G__48713","G__48714","cljs.core.keyword","cljs.core/name","screen","p__48718","map__48719","breaking-point.core/set-breakpoints","G__48726","re-frame.core/dispatch","G__48728","G__48729","re-frame.core/reg-fx"],"sourcesContent":["(ns breaking-point.core\n  (:require\n   [re-frame.core :as rf]\n   [re-frame-fx.dispatch]\n   ))\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;; PUBLIC API\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n(rf/reg-event-fx\n ::set-breakpoints\n (fn [_ [_ {:keys [breakpoints ;; required\n                   debounce-ms ;; optional\n                   ]\n            :as   opts}]]\n   {::set-breakpoints opts}))\n\n\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;; Implementation\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n;; COFX\n\n(rf/reg-cofx\n ::screen-dimensions\n (fn [coeffect]\n   (let [screen-width  (or (some-> js/window\n                                   .-innerWidth)\n                           (some-> js/document\n                                   .-documentElement\n                                   .-clientWidth)\n                           (some-> js/document\n                                   .-body\n                                   .-clientWidth))\n         screen-height (or (some-> js/window\n                                   .-innerHeight)\n                           (some-> js/document\n                                   .-documentElement\n                                   .-clientHeight)\n                           (some-> js/document\n                                   .-body\n                                   .-clientHeight))]\n     (assoc coeffect\n            :screen-width screen-width\n            :screen-height screen-height))))\n\n\n;; Events\n\n(defn set-screen-dimensions\n  [{:keys [db\n           screen-width\n           screen-height]} _]\n  {:db (-> db\n           (assoc-in [::breakpoints :screen-width] screen-width)\n           (assoc-in [::breakpoints :screen-height] screen-height))})\n\n(rf/reg-event-fx ::set-screen-dimensions\n                 [(rf/inject-cofx ::screen-dimensions)]\n                 set-screen-dimensions)\n\n(rf/reg-event-fx ::set-screen-dimensions-debounced\n                 (fn [_ [_ debounce-ms]]\n                   {:dispatch-debounce [{:id      ::calcaulate-width-after-resize\n                                         :timeout debounce-ms\n                                         :action  :dispatch\n                                         :event   [::set-screen-dimensions]}]}))\n\n\n;; Subs\n\n(defn get-screen-width [db _]\n  (get-in db [::breakpoints :screen-width]))\n\n(defn get-screen-height [db _]\n  (get-in db [::breakpoints :screen-height]))\n\n\n(defn ->get-screen [breakpoints]\n  (fn get-screen\n    [screen-width _]\n    (when screen-width\n      (reduce\n       (fn [prev-breakpoint [screen-key breakpoint]]\n         (if (or (nil? breakpoint)\n                 (and (< screen-width breakpoint)\n                      (>= screen-width prev-breakpoint)))\n           (reduced screen-key)\n           breakpoint))\n       0\n       (partition-all 2 breakpoints)))))\n\n\n(defn get-orientation\n  [[screen-width\n    screen-height] _]\n  (if (> screen-height\n         screen-width)\n    :portrait\n    :landscape))\n\n\n(defn register-subs [breakpoints]\n  (rf/reg-sub ::screen-width get-screen-width)\n  (rf/reg-sub ::screen-height get-screen-height)\n\n  (rf/reg-sub ::screen\n              :<- [::screen-width]\n              (->get-screen breakpoints))\n\n  (rf/reg-sub ::orientation\n              :<- [::screen-width]\n              :<- [::screen-height]\n              get-orientation)\n\n  (rf/reg-sub ::portrait?\n              :<- [::orientation]\n              (fn [orientation _]\n                (= orientation :portrait)))\n\n  (rf/reg-sub ::landscape?\n              :<- [::orientation]\n              (fn [orientation _]\n                (= orientation :landscape)))\n\n  (let [screen-keys (some->> breakpoints\n                             (map-indexed vector)\n                             (filter (fn [[i k]]\n                                       (even? i)))\n                             (mapv second))]\n    (doseq [screen-key screen-keys]\n      (rf/reg-sub (keyword \"breaking-point.core\"\n                           (str (name screen-key) \"?\"))\n                  :<- [::screen]\n                  (fn [screen _]\n                    (= screen\n                       screen-key))))))\n\n\n;; FX\n\n(defn set-breakpoints [{:keys [breakpoints\n                               debounce-ms]\n                        :as   opts}]\n  (register-subs breakpoints)\n  (rf/dispatch [::set-screen-dimensions])\n  (.addEventListener js/window \"resize\"\n                     #(if debounce-ms\n                        (rf/dispatch [::set-screen-dimensions-debounced debounce-ms])\n                        (rf/dispatch [::set-screen-dimensions]))\n                     true))\n\n(rf/reg-fx\n ::set-breakpoints\n set-breakpoints)\n"]}